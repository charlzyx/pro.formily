# ğŸª‚ Pro Enum

> ProEnum æ˜¯ä¸ºäº†è§£å†³å¸¸è§çš„ æšä¸¾/Select/Checkbox.Group/Radio.Group ç”šè‡³Suggestion/Cascader çš„å¼‚æ­¥æ•°æ®æºçš„è§£å†³æ–¹æ¡ˆ


## è®¾è®¡æ€è·¯
Formily æ¨¡å‹ä¸­çš„ `enum` å­—æ®µèƒ½å¤Ÿæ»¡è¶³æœ¬åœ°çš„æšä¸¾è¯å…¸çš„éœ€æ±‚, ä½†è¿œç¨‹çš„å…¶å®æ›´å¸¸ç”¨ä¸€äº›; åŸºäºè¿™ä¸ªäº‹å®ï¼Œä½¿ç”¨[å½’çº³æ¼”ç»æ³•](https://mp.weixin.qq.com/s/9gCJudLQTjVMcm4DzMbgvA), å¯ä»¥å‘ç°ï¼Œä¸Šé¢æåˆ°çš„å‡ ä¸ªç»„ä»¶ï¼Œæ‰€ç”¨åˆ°çš„æ•°æ®æºï¼Œ å¯ä»¥å½’çº³ä¸ºä¸‹é¢è¿™ç§æ ¼å¼;

```tsx | pure
type Value = string | number;
export type ProEnumItem = {
  label: string;
  value: Value;
  disabled?: boolean;
  /** tree like */
  isLeaf?: boolean;
  children?: ProEnumItem[];
  /** lazy */
  loading?: boolean;
  /** read pretty */
  color?: keyof typeof BUILTIN_COLOR | (string & {});
};
```

å› æ­¤, è®¾è®¡äº†ä¸€ä¸ªä¸“ç”¨çš„ `ProEnum` ç»„ä»¶ï¼Œ æ¥å¢å¼ºåŸæœ‰çš„ `enum` å±æ€§çš„è¡¨ç°åŠ›ï¼Œå½“ç„¶ï¼Œ è¿™éœ€è¦æˆ‘ä»¬ä½¿ç”¨ `useProEnumEffects` ä½¿ç”¨ `FieldEffects` å¯¹ Field æ”¹è¿›åŠ«æŒã€‚

### é’ˆå¯¹ Select/Radio.Group/Checkbox.Group

æ¥è®², åŠ«æŒåŠ¨ä½œåŒ…å«ä¸¤éƒ¨åˆ†

- `enum` å±æ€§æ”¯æŒ `ProEnum` å®ä¾‹ï¼Œ è€Œè¿™ï¼Œ æ˜¯ä¸€ä¸ªæ”¯æŒè¿œç¨‹åŠ è½½çš„æšä¸¾, å¹¶åœ¨ç»„ä»¶ init é’©å­ä¸­è¿›è¡Œè‡ªåŠ¨åŠ å¹¶æ³¨å…¥çš„ field.dataSource å±æ€§ï¼Œ ä¹Ÿå°±æ˜¯ enum åŸæ¥å¯¹åº”çš„å±æ€§å€¼

- åŠ«æŒ `readPretty` å½¢æ€ä¸‹çš„ field.componentType, ä¼˜åŒ–æšä¸¾å€¼çš„å±•ç¤º

### é’ˆå¯¹ Suggestion/Cascader è¿™ç§

- æ ¹æ® `lazyTree` åˆ¤æ–­æ˜¯å¦æ˜¯æ‡’åŠ è½½çš„æ ‘çŠ¶æ•°æ®ï¼Œ å¦‚æœæ˜¯æ ‘çŠ¶æ•°æ®ï¼Œå°†åœ¨æ‹¼è£…å®Œæˆåï¼Œ ä¼ é€’ç»™ dataSource

- æ ¹æ® debounce æ˜¯å¦ >0 ,è¯·æ±‚ä¼šè¿›è¡Œé˜²æŠ–å¤„ç†

## ä»£ç æ¡ˆä¾‹

å¦‚æ­¤ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡å›ºå®šçš„å½¢å¼ï¼Œ æ–¹ä¾¿çš„åœ¨ Formliy ä¸­ä½¿ç”¨å¼‚æ­¥çš„æšä¸¾å€¼, ä»¥åŠè½»æ¾çš„é€‚é… Suggestion(Select)/CascaderPlus

<code src="../demos/ProEnum.tsx"  />

## API

### ProEnum

pretty åŠ«æŒå±æ€§

```ts | pure
/**
 * Schema ä¸Šçš„é…ç½®
 * @example
 * {
 *  type: 'string',
 *  enum: ProEnum.from([]),
 *  "x-component-props": {
 *     enum: {
 *       hijack: false,
 *     }
 *  }
 * }
 */
type ProEnumSchemaOption = Pick<ProEnumOption, "mapToProp"> & {
  pretty?: boolean;
  showType?: React.ComponentProps<typeof ProEnumPretty>["showType"];
  strict?: React.ComponentProps<typeof ProEnumPretty>["strictMode"];
  // é¢å¤–çš„è¯·æ±‚å‚æ•°
  params?: any;
};

/** åˆ›å»ºæ—¶å€™çš„é…ç½® */
type ProEnumOption = {
  mapToProp?: string;
  cache?: boolean;
  // > 0 å¯ç”¨
  debounce?: number;
  lazyTree?: boolean;
  colorful?: boolean;
  // æ˜¯å¦åŠ«æŒ read pretty
  pretty?: boolean;
};

type TItemsOrLoader =
  | ProEnumItem[]
  | ((params?: any) => Promise<ProEnumItem[]>);

export class ProEnum {
  static from(optionsOrLoader: TItemsOrLoader, opt?: ProEnumOption) {
    return new ProEnum(optionsOrLoader, opt);
  }

  static is(x: any): x is ProEnum {
    return x instanceof ProEnum;
  }

  isAsync = false;
  remapPropName: string | null = null;
  options: ProEnumItem[] = [];

  loader(params?: any): Promise<ProEnumItem[]> {
    return Promise.resolve(this.options);
  }
}
```

### Schema å±æ€§

åœ¨ Schema è¡¨è¾¾å¼ä¸­ï¼Œ ä½¿ç”¨ x-data#enum è¿™ä¸ªå­—æ®µå¯ä»¥æ·»åŠ ä¸€äº›å±æ€§

```json
{

  "proEnum": {
    "type": "string",
    "x-data": {
      "enum": {
        "mapToProp": "loadData",
        // TODO: test compile
        "params": "{{object or expression}}",
      }
    }
  }
}
```

