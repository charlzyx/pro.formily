# ğŸ“• Dict - è¿œç¨‹è¯å…¸

> Formily æ¨¡å‹ä¸­çš„ `enum` å­—æ®µèƒ½å¤Ÿæ»¡è¶³æœ¬åœ°çš„æšä¸¾è¯å…¸çš„éœ€æ±‚, ä½†è¿œç¨‹çš„å…¶å®æ›´å¸¸ç”¨ä¸€äº›;


## è®¾è®¡æ€è·¯

ä¸šåŠ¡ä¸­ä¸€ä¸ªå¸¸è§çš„åœºæ™¯æ˜¯ï¼Œä»è¿œç¨‹æ‹‰å–ä¸€ä¸ª kv è¯å…¸åˆ—è¡¨, ä½œä¸º `Select/Checkbox.Group/Radio.Group/` çš„ `options` ä½¿ç”¨;
æ ¹æ®å¯¹åº”çš„ `key` å€¼è·å–å¯¹åº”çš„ `value` å€¼å±•ç¤ºå‡ºæ¥, äº¦æˆ–åå‘çš„æ ¹æ® `value` å–å‡º `key` å€¼;

ä½¿ç”¨åŸºæœ¬çš„å½’çº³æ¼”ç»æ³•, å¯ä»¥ä½¿ç”¨ä¸€ä¸ªçº¦å®šçš„æ•°æ®æ ¼å¼ä¸æ–¹å¼, å°†è¿™äº›ç±»ä¼¼çš„åœºæ™¯ä¸­ä½¿ç”¨æ¨¡å¼å›ºå®šä¸‹æ¥.

è®¾è®¡ä¸€ä¸ªè¯å…¸çš„æ ‡å‡†ç»“æ„çº¦å®šå¦‚ä¸‹:

```tsx | pure
export type TDictShape = {
  // åŒå‘æ˜ å°„è¡¨
  emap: {
    [x: string]: string | number;
    [x: number]: string | number;
  };
  // åˆ—è¡¨å½¢å¼çš„å­˜å‚¨
  options: {
    label: string;
    value: string | number;
    key?: string | number;
    color?: ColorsKey;
  }[];
  // on more things~ å› ä¸ºä¼šåœ¨ Tag/Badge ä¸­ä½¿ç”¨, é¢å¤–å¢åŠ çš„é¢œè‰²é…ç½®
  colors: {
    [x: string]: string;
    [x: number]: string;
  };
};
```

å½“ç„¶æˆ‘ä»¬å¹¶ä¸å¸Œæœ›å¡«å†™è¿™ä¹ˆå¤šå±æ€§å€¼, ç»§ç»­çº¦å®šä¸€ä¸ªæœ€åŸºæœ¬çš„åŸå§‹æ•°æ® `label/value`, å…¶ä½™å±æ€§æˆ‘ä»¬éƒ½å¯ä»¥è½¬æ¢å‡ºæ¥.

```tsx | pure
type DictLoader = () => Promise<{ label: string, value: string | number, color: string }>
// å½“ç„¶, ä¸å¯èƒ½åªæœ‰ä¸€ä¸ªè¯å…¸å¯¹ä¸å¯¹
type registerDictLoader = (name: string, loader: DictLoader) => Promise<TDictShape>
```

## æœ€ç»ˆå®ç°

```tsx | pure
import { registerDictLoader, dict } from '@pro.formily/antd'
```

çº¦å®šä¸€ä¸ªæ ‡å‡†çš„è¯å…¸åŠ è½½å™¨ `registerDictLoader`, æ ¹æ®å‘½åå°†å¯¹åº”è¯å…¸æ³¨å†Œåˆ°å†…å­˜ä¸­çš„å…¨å±€ç¼“å­˜;

ä¸€ä¸ªæœ€ç®€å•çš„ä¾‹å­

> color å¹¶ä¸æ˜¯å¿…å¡«é¡¹,  ä¸å¡«å†™çš„è¯ï¼Œä¼šæ ¹æ®å†…ç½®çš„10ä¸ªé¢œè‰²é¡ºåºè¯»å–

```tsx | pure
// æ³¨å†Œ
const loader = registerDictLoader("bool", () => {
  return Promise.resolve([
    { label: "æ˜¯", value: 1 },
    { label: "å¦", value: 0, color: "error" },
  ]);
});
// ä¸ä½¿ç”¨
loader().then(dictshape => console.log(dictshape))
// or
dict.bool?.emap
```

å¦ä¸€ä¸ªå¯¼å‡º `dict` æ˜¯ä¸€ä¸ªå…¨å±€å”¯ä¸€çš„ `observeable({})` å€¼, ç»“åˆ `observer`, æˆ‘ä»¬å¯ä»¥å¾ˆæ–¹ä¾¿çš„åœ¨ç»„ä»¶ä¸­ä½¿ç”¨

### ä»£ç æ¡ˆä¾‹: ç»“åˆ `observer` ä¸­ä½¿ç”¨

<code src="../demos/DictDemo2.tsx" />

åœ¨ Formily ä¸­ä½¿ç”¨çš„è¯, æˆ‘ä»¬å¯ä»¥ç»“åˆ `effect` å’Œ `schema` é…ç½®,
```tsx | pure
import { dictEffects } from '@pro.formily/antd';
const form = createForm({
  effects(form) {
    dictEffects(form)
  }
})

const schema = {
  type: 'string',
  "x-component": "Select",
  "x-data": {
    // è¯å…¸åç§°;
    dict: "bool",
    // é»˜è®¤è¿›è¡Œç¼“å­˜;
    dictNoCache: false,
  },
}
```

åˆ©ç”¨ Schema ä½¿ç”¨ `x-data` å­—æ®µ, æ·»åŠ äº†è¯å…¸å±æ€§, åœ¨`dictEffects` ä¸­, æƒ°æ€§åŠ è½½è¿œç¨‹è¯å…¸, å¹¶æ³¨å…¥ `field.dataSource/options` å±æ€§;

é¢å¤–çš„, `readPretty` æƒ…å†µä¸‹åŠ«æŒä¸ºä¼˜åŒ–å½¢æ€ `Badge/Tag`

## ä»£ç æ¡ˆä¾‹: åœ¨ Formily ä¸­ä½¿ç”¨

<code src="../demos/DictDemo.tsx" />

